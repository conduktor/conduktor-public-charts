# Kafka test configuration for Conduktor charts
# Uses bitnamilegacy images and KRaft mode (no Zookeeper)

image:
  repository: bitnamilegacy/kafka
  tag: "3.9.0-debian-12-r1"

externalAccess:
  autoDiscovery:
    image:
      repository: bitnamilegacy/kubectl

volumePermissions:
  image:
    repository: bitnamilegacy/os-shell

metrics:
  jmx:
    image:
      repository: bitnamilegacy/jmx-exporter

# KRaft mode (no Zookeeper)
kraft:
  enabled: true

# Listeners configuration
listeners:
  client:
    protocol: PLAINTEXT
    port: 9092
  controller:
    protocol: PLAINTEXT
    port: 9093
  interBroker:
    protocol: PLAINTEXT
    port: 9094

# Single broker for tests
controller:
  replicaCount: 1
  resources:
    limits:
      cpu: 1000m
      memory: 1Gi
    requests:
      cpu: 250m
      memory: 512Mi
  persistence:
    enabled: false

broker:
  replicaCount: 0  # Combined mode - controller acts as broker

# Kafka configuration optimized for testing
extraConfig: |
  default.replication.factor=1
  offsets.topic.replication.factor=1
  transaction.state.log.replication.factor=1
  transaction.state.log.min.isr=1
  min.insync.replicas=1

# Disable features not needed for tests
provisioning:
  enabled: false
